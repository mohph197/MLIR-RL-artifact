
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mohph197.github.io/MLIR-RL-artifact/api_reference/trajectory/">
      
      
        <link rel="prev" href="../state/">
      
      
        <link rel="next" href="../transforms/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Trajectory - MLIR RL</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mlir_rl_artifact.trajectory" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MLIR RL" class="md-header__button md-logo" aria-label="MLIR RL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MLIR RL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Trajectory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mohph197/MLIR-RL-artifact" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mohph197/MLIR-RL-artifact
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MLIR RL" class="md-nav__button md-logo" aria-label="MLIR RL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MLIR RL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mohph197/MLIR-RL-artifact" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mohph197/MLIR-RL-artifact
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MLIR RL
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Api reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Api reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Env
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Trajectory
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Trajectory
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trajectory
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.DYNAMIC_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        DYNAMIC_ATTRS
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.T_timestep" class="md-nav__link">
    <span class="md-ellipsis">
      
        T_timestep
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        TopKAdvantageSampler
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TopKAdvantageSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector" class="md-nav__link">
    <span class="md-ellipsis">
      
        TrajectoryCollector
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrajectoryCollector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.actions_bev_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_bev_log_p
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.actions_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.done" class="md-nav__link">
    <span class="md-ellipsis">
      
        done
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.next_obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.num_loops" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_loops
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.append" class="md-nav__link">
    <span class="md-ellipsis">
      
        append
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.to_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_trajectory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData" class="md-nav__link">
    <span class="md-ellipsis">
      
        TrajectoryData
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrajectoryData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_bev_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_bev_log_p
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_old_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_old_log_p
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.advantages" class="md-nav__link">
    <span class="md-ellipsis">
      
        advantages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.done" class="md-nav__link">
    <span class="md-ellipsis">
      
        done
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.next_obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.next_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.num_loops" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_loops
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.off_policy_rates" class="md-nav__link">
    <span class="md-ellipsis">
      
        off_policy_rates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.sizes" class="md-nav__link">
    <span class="md-ellipsis">
      
        sizes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.values" class="md-nav__link">
    <span class="md-ellipsis">
      
        values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__add__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __add__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_gae" class="md-nav__link">
    <span class="md-ellipsis">
      
        __compute_gae
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        __compute_returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_rho" class="md-nav__link">
    <span class="md-ellipsis">
      
        __compute_rho
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        copy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.loader" class="md-nav__link">
    <span class="md-ellipsis">
      
        loader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.update_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_attributes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transforms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Actions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Actions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Action Space
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/interchange/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interchange
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/no_transformation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    No Transformation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/tiled_fusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiled Fusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/tiled_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiled Parallelization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/tiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/vectorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vectorization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/bindings_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bindings Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/dask_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dask Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/file_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Logger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/gpu_occupier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GPU Occupier
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Log
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/singleton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Singleton
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Entry points
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Entry points
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../entry_points/evaluate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Script
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../entry_points/train/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Script
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trajectory
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.DYNAMIC_ATTRS" class="md-nav__link">
    <span class="md-ellipsis">
      
        DYNAMIC_ATTRS
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.T_timestep" class="md-nav__link">
    <span class="md-ellipsis">
      
        T_timestep
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler" class="md-nav__link">
    <span class="md-ellipsis">
      
        TopKAdvantageSampler
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TopKAdvantageSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector" class="md-nav__link">
    <span class="md-ellipsis">
      
        TrajectoryCollector
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrajectoryCollector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.actions_bev_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_bev_log_p
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.actions_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.done" class="md-nav__link">
    <span class="md-ellipsis">
      
        done
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.next_obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.num_loops" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_loops
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.append" class="md-nav__link">
    <span class="md-ellipsis">
      
        append
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.reset" class="md-nav__link">
    <span class="md-ellipsis">
      
        reset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.to_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_trajectory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData" class="md-nav__link">
    <span class="md-ellipsis">
      
        TrajectoryData
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrajectoryData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_bev_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_bev_log_p
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_old_log_p" class="md-nav__link">
    <span class="md-ellipsis">
      
        actions_old_log_p
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.advantages" class="md-nav__link">
    <span class="md-ellipsis">
      
        advantages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.done" class="md-nav__link">
    <span class="md-ellipsis">
      
        done
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.next_obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.next_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.num_loops" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_loops
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.obs" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.off_policy_rates" class="md-nav__link">
    <span class="md-ellipsis">
      
        off_policy_rates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.sizes" class="md-nav__link">
    <span class="md-ellipsis">
      
        sizes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.values" class="md-nav__link">
    <span class="md-ellipsis">
      
        values
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__add__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __add__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_gae" class="md-nav__link">
    <span class="md-ellipsis">
      
        __compute_gae
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        __compute_returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_rho" class="md-nav__link">
    <span class="md-ellipsis">
      
        __compute_rho
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        copy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.loader" class="md-nav__link">
    <span class="md-ellipsis">
      
        loader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlir_rl_artifact.trajectory.TrajectoryData.update_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_attributes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="trajectory">Trajectory<a class="headerlink" href="#trajectory" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="mlir_rl_artifact.trajectory"></a>
    <div class="doc doc-contents first">

        <p>Trajectory data structures and utilities for RL training.</p>
<p>This module provides classes for collecting and managing trajectory data during RL training,
including trajectory storage, data loading, advantage computation, and experience replay.
It implements the TrajectoryData dataset interface and trajectory collection utilities.</p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="mlir_rl_artifact.trajectory.DYNAMIC_ATTRS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">DYNAMIC_ATTRS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="s1">&#39;next_values&#39;</span><span class="p">,</span> <span class="s1">&#39;actions_old_log_p&#39;</span><span class="p">,</span> <span class="s1">&#39;off_policy_rates&#39;</span><span class="p">,</span> <span class="s1">&#39;returns&#39;</span><span class="p">,</span> <span class="s1">&#39;advantages&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.DYNAMIC_ATTRS" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>List of dynamic attributes that are computed during trajectory processing.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="mlir_rl_artifact.trajectory.T_timestep" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">T_timestep</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.T_timestep" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Type alias for a single timestep in the trajectory.</p>

    </div>

</div>



<div class="doc doc-object doc-class">



<h2 id="mlir_rl_artifact.trajectory.TopKAdvantageSampler" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">TopKAdvantageSampler</span><span class="p">(</span><span class="n">data_source</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="torch.utils.data.Sampler" href="https://docs.pytorch.org/docs/2.8/data.html#torch.utils.data.Sampler">Sampler</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a>]</code></p>



        <p>Sampler that yields indices of top-K advantage samples in random order.</p>
<p>Selects the top-K samples with highest absolute advantage values for experience
replay. This focuses training on the most impactful samples.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="mlir_rl_artifact.trajectory.TopKAdvantageSampler.data_source">data_source</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="              TrajectoryData(num_loops, actions_index, obs, next_obs, actions_bev_log_p, rewards, done) (mlir_rl_artifact.trajectory.TrajectoryData)" href="#mlir_rl_artifact.trajectory.TrajectoryData">TrajectoryData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trajectory dataset.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="mlir_rl_artifact.trajectory.TopKAdvantageSampler.num_samples">num_samples</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of top samples to include.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_source</span><span class="p">:</span> <span class="s1">&#39;TrajectoryData&#39;</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_source</span> <span class="o">=</span> <span class="n">data_source</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">=</span> <span class="n">num_samples</span>

    <span class="c1"># Get all advantage values from the dataset</span>
    <span class="n">advantages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_source</span><span class="o">.</span><span class="n">advantages</span>

    <span class="c1"># Ensure we don&#39;t request more samples than available</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">advantages</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_k_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="n">advantages</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TopKAdvantageSampler.__iter__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler.__iter__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns an iterator over shuffled indices of the top-k samples.
This is called by the DataLoader at the start of each epoch.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an iterator over shuffled indices of the top-k samples.</span>
<span class="sd">    This is called by the DataLoader at the start of each epoch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Shuffle the top-k indices to ensure random order</span>
    <span class="n">shuffled_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_k_indices</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">randperm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)]</span>

    <span class="c1"># Yield the indices one by one</span>
    <span class="k">yield from</span> <span class="n">shuffled_indices</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TopKAdvantageSampler.__len__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TopKAdvantageSampler.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The total number of samples to be drawn.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The total number of samples to be drawn.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mlir_rl_artifact.trajectory.TrajectoryCollector" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">TrajectoryCollector</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



        <p>Class that appends timestep data to a trajectory.</p>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the trajectory collector.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.actions_bev_log_p" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">actions_bev_log_p</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.actions_bev_log_p" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Action log probabilities following behavioral policy in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.actions_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">actions_index</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.actions_index" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Actions in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.done" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">done</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.done" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Done flags in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.next_obs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">next_obs</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.next_obs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Observations of next states in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.num_loops" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">num_loops</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.num_loops" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of loops in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.obs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">obs</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.obs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Observations in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.rewards" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">rewards</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.rewards" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Rewards in the trajectory.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.append" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.append" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Append a single timestep to the trajectory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_timestep = tuple[int, torch.Tensor, torch.Tensor, torch.Tensor, float, float, bool]

  
      module-attribute
   (mlir_rl_artifact.trajectory.T_timestep)" href="#mlir_rl_artifact.trajectory.T_timestep">T_timestep</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The timestep data to append.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestep</span><span class="p">:</span> <span class="n">T_timestep</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Append a single timestep to the trajectory.</span>

<span class="sd">    Args:</span>
<span class="sd">        timestep (T_timestep): The timestep data to append.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestep</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.reset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reset the trajectory collector.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset the trajectory collector.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryCollector.to_trajectory" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">to_trajectory</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryCollector.to_trajectory" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert the collected data to a TrajectoryData object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TrajectoryData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="              TrajectoryData(num_loops, actions_index, obs, next_obs, actions_bev_log_p, rewards, done) (mlir_rl_artifact.trajectory.TrajectoryData)" href="#mlir_rl_artifact.trajectory.TrajectoryData">TrajectoryData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trajectory containing all collected data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrajectoryData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the collected data to a TrajectoryData object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TrajectoryData: The trajectory containing all collected data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">TrajectoryData</span><span class="p">(</span>
        <span class="n">num_loops</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
        <span class="n">actions_index</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span><span class="p">),</span>
        <span class="n">obs</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">),</span>
        <span class="n">next_obs</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span><span class="p">),</span>
        <span class="n">actions_bev_log_p</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="n">rewards</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="n">done</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mlir_rl_artifact.trajectory.TrajectoryData" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">TrajectoryData</span><span class="p">(</span><span class="n">num_loops</span><span class="p">,</span> <span class="n">actions_index</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">next_obs</span><span class="p">,</span> <span class="n">actions_bev_log_p</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="torch.utils.data.Dataset" href="https://docs.pytorch.org/docs/2.8/data.html#torch.utils.data.Dataset">Dataset</a></code></p>



        <p>Dataset to store the trajectory data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_loops</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of loops in the trajectory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actions_index</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actions indices in the trajectory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observations in the trajectory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>next_obs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observations of next states in the trajectory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actions_bev_log_p</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action log probabilities following behavioral policy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rewards</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rewards in the trajectory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>done</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Done flags in the trajectory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_loops</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">actions_index</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">obs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">next_obs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">actions_bev_log_p</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">rewards</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span> <span class="o">=</span> <span class="n">num_loops</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span> <span class="o">=</span> <span class="n">actions_index</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="o">=</span> <span class="n">obs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span> <span class="o">=</span> <span class="n">next_obs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span> <span class="o">=</span> <span class="n">actions_bev_log_p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span> <span class="o">=</span> <span class="n">rewards</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="n">done</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.actions_bev_log_p" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">actions_bev_log_p</span> <span class="o">=</span> <span class="n">actions_bev_log_p</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_bev_log_p" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Action log probabilities following behavioral policy in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.actions_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">actions_index</span> <span class="o">=</span> <span class="n">actions_index</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_index" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Actions in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.actions_old_log_p" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">actions_old_log_p</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.actions_old_log_p" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Action log probabilities following old policy in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.advantages" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">advantages</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.advantages" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Advantages in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.done" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">done</span> <span class="o">=</span> <span class="n">done</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.done" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Done flags in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.next_obs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">next_obs</span> <span class="o">=</span> <span class="n">next_obs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.next_obs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Observations of next states in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.next_values" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">next_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.next_values" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Values of actions in the trajectory with one additional step (shifted to one step in the future).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.num_loops" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">num_loops</span> <span class="o">=</span> <span class="n">num_loops</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.num_loops" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of loops in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.obs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">obs</span> <span class="o">=</span> <span class="n">obs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.obs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Observations in the trajectory</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.off_policy_rates" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">off_policy_rates</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.off_policy_rates" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Off-policy rates (rho) for the current policy.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.returns" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">returns</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.returns" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.rewards" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">rewards</span> <span class="o">=</span> <span class="n">rewards</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.rewards" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Rewards in the trajectory.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.sizes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.sizes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Sizes of all the included trajectories</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.values" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.values" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Values of actions in the trajectory.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.__add__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.__add__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Concatenate this trajectory with another.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="              TrajectoryData(num_loops, actions_index, obs, next_obs, actions_bev_log_p, rewards, done) (mlir_rl_artifact.trajectory.TrajectoryData)" href="#mlir_rl_artifact.trajectory.TrajectoryData">TrajectoryData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The other trajectory to concatenate with</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TrajectoryData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="              TrajectoryData(num_loops, actions_index, obs, next_obs, actions_bev_log_p, rewards, done) (mlir_rl_artifact.trajectory.TrajectoryData)" href="#mlir_rl_artifact.trajectory.TrajectoryData">TrajectoryData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trajectory containing both</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TrajectoryData&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TrajectoryData&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Concatenate this trajectory with another.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (TrajectoryData): The other trajectory to concatenate with</span>

<span class="sd">    Returns:</span>
<span class="sd">        TrajectoryData: The trajectory containing both</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">self_other_sizes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">sizes</span>

    <span class="c1"># Truncate to 10 trajectories</span>
    <span class="n">self_other_sizes</span> <span class="o">=</span> <span class="n">self_other_sizes</span><span class="p">[</span><span class="o">-</span><span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">replay_count</span><span class="p">:]</span>
    <span class="n">start</span> <span class="o">=</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">self_other_sizes</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">self_other_sizes</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">replay_count</span>

    <span class="n">self_other</span> <span class="o">=</span> <span class="n">TrajectoryData</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">num_loops</span><span class="p">))[</span><span class="n">start</span><span class="p">:],</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">actions_index</span><span class="p">))[</span><span class="n">start</span><span class="p">:],</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">obs</span><span class="p">))[</span><span class="n">start</span><span class="p">:],</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">next_obs</span><span class="p">))[</span><span class="n">start</span><span class="p">:],</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="p">))[</span><span class="n">start</span><span class="p">:],</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">rewards</span><span class="p">))[</span><span class="n">start</span><span class="p">:],</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">done</span><span class="p">))[</span><span class="n">start</span><span class="p">:],</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">DYNAMIC_ATTRS</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
            <span class="n">self_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="n">other_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">self_val</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_val</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">self_other</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">self_val</span><span class="p">,</span> <span class="n">other_val</span><span class="p">))[</span><span class="n">start</span><span class="p">:])</span>

    <span class="n">self_other</span><span class="o">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="n">self_other_sizes</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">self_other</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">self_other_sizes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">self_other</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.__compute_gae" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">__compute_gae</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_gae" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the Generalized Advantage Estimation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>gamma</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>discount factor.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lambda_</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GAE factor.</p>
              </div>
            </td>
            <td>
                  <code>0.95</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.Tensor: advantages.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.Tensor: returns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__compute_gae</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the Generalized Advantage Estimation.</span>

<span class="sd">    Args:</span>
<span class="sd">        gamma (float): discount factor.</span>
<span class="sd">        lambda_ (float): GAE factor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        torch.Tensor: advantages.</span>
<span class="sd">        torch.Tensor: returns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">advantages</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">last_advantage</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">last_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">mask</span>
        <span class="n">last_advantage</span> <span class="o">=</span> <span class="n">last_advantage</span> <span class="o">*</span> <span class="n">mask</span>

        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">last_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">last_advantage</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">last_advantage</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">advantages</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_advantage</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.__compute_returns" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">__compute_returns</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_returns" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the returns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>gamma</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>discount factor. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.Tensor: returns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__compute_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the returns.</span>

<span class="sd">    Args:</span>
<span class="sd">        gamma (float): discount factor. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        torch.Tensor: returns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">returns</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">last_return</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">last_return</span> <span class="o">=</span> <span class="n">last_return</span> <span class="o">*</span> <span class="n">mask</span>

        <span class="n">last_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">last_return</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">off_policy_rates</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">clamp_max</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">returns</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.__compute_rho" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">__compute_rho</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.__compute_rho" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the off-policy rate (rho) for the current policy.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.Tensor: The off-policy rate.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__compute_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the off-policy rate (rho) for the current policy.</span>

<span class="sd">    Returns:</span>
<span class="sd">        torch.Tensor: The off-policy rate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;epsilon&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">exploration</span> <span class="ow">and</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">reuse_experience</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">off_policy_rates</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">off_policy_rates</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_old_log_p</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="p">,</span> <span class="o">-</span><span class="mf">80.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.__getitem__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.__getitem__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a single timestep from the trajectory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>idx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the timestep to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="torch.Tensor" href="https://docs.pytorch.org/docs/2.8/tensors.html#torch.Tensor">Tensor</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[torch.Tensor, ...]: A tuple containing the timestep data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a single timestep from the trajectory.</span>

<span class="sd">    Args:</span>
<span class="sd">        idx (int): Index of the timestep to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[torch.Tensor, ...]: A tuple containing the timestep data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next_values</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions_old_log_p</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">off_policy_rates</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">returns</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advantages</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.__len__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the length of the trajectory.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The length of the trajectory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the length of the trajectory.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The length of the trajectory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.copy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.copy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Copy the trajectory.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TrajectoryData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="              TrajectoryData(num_loops, actions_index, obs, next_obs, actions_bev_log_p, rewards, done) (mlir_rl_artifact.trajectory.TrajectoryData)" href="#mlir_rl_artifact.trajectory.TrajectoryData">TrajectoryData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The copied trajectory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TrajectoryData&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy the trajectory.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TrajectoryData: The copied trajectory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">self_copy</span> <span class="o">=</span> <span class="n">TrajectoryData</span><span class="p">(</span>
        <span class="n">num_loops</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_loops</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span>
        <span class="n">actions_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span>
        <span class="n">obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span>
        <span class="n">next_obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span>
        <span class="n">actions_bev_log_p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">actions_bev_log_p</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span>
        <span class="n">rewards</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span>
        <span class="n">done</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">done</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">DYNAMIC_ATTRS</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
            <span class="n">attr_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_val</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">self_copy</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">attr_val</span><span class="o">.</span><span class="n">clone</span><span class="p">())</span>

    <span class="n">self_copy</span><span class="o">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">self_copy</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.loader" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">loader</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_trajectories</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.loader" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a DataLoader for the trajectory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Batch size for the DataLoader.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_trajectories</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of trajectories to use for training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DataLoader</code></td>            <td>
                  <code><a class="autorefs autorefs-external" title="torch.utils.data.DataLoader" href="https://docs.pytorch.org/docs/2.8/data.html#torch.utils.data.DataLoader">DataLoader</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataLoader for the trajectory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">num_trajectories</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a DataLoader for the trajectory.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_size (int): Batch size for the DataLoader.</span>
<span class="sd">        num_trajectories (int): Number of trajectories to use for training.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataLoader: The DataLoader for the trajectory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_samples</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="o">-</span><span class="n">num_trajectories</span><span class="p">:])</span>
    <span class="k">if</span> <span class="n">batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">num_samples</span>
    <span class="k">match</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">reuse_experience</span><span class="p">:</span>
        <span class="k">case</span> <span class="s1">&#39;topk&#39;</span><span class="p">:</span>
            <span class="n">sampler</span> <span class="o">=</span> <span class="n">TopKAdvantageSampler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
        <span class="k">case</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="n">sampler</span> <span class="o">=</span> <span class="n">RandomSampler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)</span>
        <span class="k">case</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">sampler</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="n">sampler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span>
        <span class="n">pin_memory</span><span class="o">=</span><span class="n">device</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s1">&#39;cpu&#39;</span><span class="p">,</span>
        <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mlir_rl_artifact.trajectory.TrajectoryData.update_attributes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">update_attributes</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.trajectory.TrajectoryData.update_attributes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the attributes of the trajectory following the new model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="              HiearchyModel() (mlir_rl_artifact.model.HiearchyModel)" href="../model/#mlir_rl_artifact.model.HiearchyModel">HiearchyModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to use for updating the attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/trajectory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the attributes of the trajectory following the new model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (Model): The model to use for updating the attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="n">actions_old_log_p</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions_index</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions_old_log_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">actions_old_log_p</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span> <span class="n">values</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">next_values</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">value_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">next_obs</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">))</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__compute_rho</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__compute_returns</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__compute_gae</span><span class="p">()</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">time_ms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">print_info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> attributes in </span><span class="si">{</span><span class="n">time_ms</span><span class="si">}</span><span class="s2">ms&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>