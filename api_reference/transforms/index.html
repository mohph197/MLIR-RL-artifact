
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mohph197.github.io/MLIR-RL-artifact/api_reference/transforms/">
      
      
        <link rel="prev" href="../trajectory/">
      
      
        <link rel="next" href="../actions/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Transforms - MLIR RL</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mlir_rl_artifact.transforms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MLIR RL" class="md-header__button md-logo" aria-label="MLIR RL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MLIR RL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Transforms
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mohph197/MLIR-RL-artifact" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mohph197/MLIR-RL-artifact
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MLIR RL" class="md-nav__button md-logo" aria-label="MLIR RL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MLIR RL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mohph197/MLIR-RL-artifact" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mohph197/MLIR-RL-artifact
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MLIR RL
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Api reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Api reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Env
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trajectory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trajectory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Transforms
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Transforms
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transforms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.__run_transform_code" class="md-nav__link">
    <span class="md-ellipsis">
      
        __run_transform_code
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.__run_transform_code_wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        __run_transform_code_wrapper
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.move_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_TF" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_TF
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_TP" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_TP
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_bufferize_and_lower_v" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_bufferize_and_lower_v
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_decompose" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_decompose
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_img2col" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_img2col
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_interchange" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_interchange
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_pre_vec" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_pre_vec
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_tile" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_tile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_transpose_conv_2d" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_transpose_conv_2d
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_vectorize" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_vectorize
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Actions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Actions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Action Space
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/interchange/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interchange
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/no_transformation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    No Transformation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/tiled_fusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiled Fusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/tiled_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiled Parallelization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/tiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../actions/vectorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vectorization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utils
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/bindings_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bindings Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/dask_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dask Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/file_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Logger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/gpu_occupier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GPU Occupier
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Log
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/singleton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Singleton
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Entry points
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Entry points
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../entry_points/evaluate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Script
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../entry_points/train/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Script
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transforms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.__run_transform_code" class="md-nav__link">
    <span class="md-ellipsis">
      
        __run_transform_code
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.__run_transform_code_wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        __run_transform_code_wrapper
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.move_module" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_TF" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_TF
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_TP" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_TP
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_bufferize_and_lower_v" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_bufferize_and_lower_v
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_decompose" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_decompose
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_img2col" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_img2col
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_interchange" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_interchange
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_pre_vec" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_pre_vec
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_tile" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_tile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_transpose_conv_2d" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_transpose_conv_2d
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlir_rl_artifact.transforms.transform_vectorize" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_vectorize
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="transforms">Transforms<a class="headerlink" href="#transforms" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="mlir_rl_artifact.transforms"></a>
    <div class="doc doc-contents first">

        <p>MLIR transformation passes for loop optimization.</p>
<p>This module provides functions for applying various loop transformation passes to MLIR code,
including tiling, interchange, parallelization, vectorization, and fusion. It interfaces
with the MLIR transform dialect for specifying and applying transformations.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.__run_transform_code" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">__run_transform_code</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.__run_transform_code" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Parse and apply MLIR transform dialect code to a module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transform_code</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR transform dialect code.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__run_transform_code</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse and apply MLIR transform dialect code to a module.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        transform_code (str): The MLIR transform dialect code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_module</span> <span class="o">=</span> <span class="n">Module</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">transform_code</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
    <span class="n">interpreter</span><span class="o">.</span><span class="n">apply_named_sequence</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">t_module</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_module</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.__run_transform_code_wrapper" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.__run_transform_code_wrapper" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Wrapper for running transform code with timeout support.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transform_code</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR transform dialect code.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper for running transform code with timeout support.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        transform_code (str): The MLIR transform dialect code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">BindingsProcess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">__run_transform_code</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.move_module" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">move_module</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.move_module" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Copy all operations from source module to destination module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source MLIR module.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The destination MLIR module where operations will be copied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_module</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy all operations from source module to destination module.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (Module): The source MLIR module.</span>
<span class="sd">        destination (Module): The destination MLIR module where operations will be copied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">destination</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span>
        <span class="n">op</span><span class="o">.</span><span class="n">erase</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span>
        <span class="n">destination</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">clone</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_TF" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_TF</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">consumer_tag</span><span class="p">,</span> <span class="n">producer_tag</span><span class="p">,</span> <span class="n">new_producer_tag</span><span class="p">,</span> <span class="n">tiling_sizes</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_TF" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply tiling and fusion transformation to consumer and producer operations.</p>
<p>Tiles the consumer with parallelization and fuses the producer into the tiled loops.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>consumer_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the consumer operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>producer_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the producer operation to fuse.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_producer_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag to assign to the fused producer.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tiling_sizes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tiling factors for consumer loops.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_TF</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">consumer_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">producer_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_producer_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tiling_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply tiling and fusion transformation to consumer and producer operations.</span>

<span class="sd">    Tiles the consumer with parallelization and fuses the producer into the tiled loops.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        consumer_tag (str): The tag of the consumer operation.</span>
<span class="sd">        producer_tag (str): The tag of the producer operation to fuse.</span>
<span class="sd">        new_producer_tag (str): The tag to assign to the fused producer.</span>
<span class="sd">        tiling_sizes (list[int]): List of tiling factors for consumer loops.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If parallel sizes are all zeros, means no fusion will be done</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">tiling_sizes</span><span class="p">]):</span>
        <span class="k">return</span>

    <span class="n">transform_code</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">module attributes </span><span class="se">{{</span><span class="s1">transform.with_named_sequence</span><span class="se">}}</span><span class="s1"> </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  transform.named_sequence @__transform_main(%arg1: !transform.any_op </span><span class="se">{{</span><span class="s1">transform.readonly</span><span class="se">}}</span><span class="s1">) </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %op_</span><span class="si">{</span><span class="n">consumer_tag</span><span class="si">}</span><span class="s1"> = transform.structured.match attributes</span><span class="se">{{</span><span class="s1">tag = &quot;</span><span class="si">{</span><span class="n">consumer_tag</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">}}</span><span class="s1"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %tiled_op_</span><span class="si">{</span><span class="n">consumer_tag</span><span class="si">}</span><span class="s1">, %forall_op_</span><span class="si">{</span><span class="n">consumer_tag</span><span class="si">}</span><span class="s1"> = transform.structured.tile_using_forall %op_</span><span class="si">{</span><span class="n">consumer_tag</span><span class="si">}</span><span class="s1"> tile_sizes </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">tiling_sizes</span><span class="p">)</span><span class="si">}</span><span class="s1"> : (!transform.any_op) -&gt; (!transform.any_op, !transform.any_op)</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %op_</span><span class="si">{</span><span class="n">producer_tag</span><span class="si">}</span><span class="s1"> = transform.structured.match attributes</span><span class="se">{{</span><span class="s1">tag = &quot;</span><span class="si">{</span><span class="n">producer_tag</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">}}</span><span class="s1"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %fused, %containing = transform.structured.fuse_into_containing_op %op_</span><span class="si">{</span><span class="n">producer_tag</span><span class="si">}</span><span class="s1"> into %forall_op_</span><span class="si">{</span><span class="n">consumer_tag</span><span class="si">}</span><span class="s1"> : (!transform.any_op, !transform.any_op) -&gt; (!transform.any_op, !transform.any_op)</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %fused_tag = transform.param.constant &quot;</span><span class="si">{</span><span class="n">new_producer_tag</span><span class="si">}</span><span class="s1">&quot; -&gt; !transform.any_param</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    transform.annotate %fused &quot;tag&quot; = %fused_tag : !transform.any_op, !transform.any_param</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    transform.yield</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  </span><span class="se">}}\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="se">}}\n</span><span class="s1">&#39;</span>
    <span class="p">)</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_TP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_TP</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">,</span> <span class="n">tiling_sizes</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_TP" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply tiling and parallelization transformation to an operation.</p>
<p>Tiles loops using forall constructs for parallelization.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the operation to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tiling_sizes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tiling factors for each loop.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_TP</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tiling_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply tiling and parallelization transformation to an operation.</span>

<span class="sd">    Tiles loops using forall constructs for parallelization.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the operation to transform.</span>
<span class="sd">        tiling_sizes (list[int]): List of tiling factors for each loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If tiling sizes are all zeros, means no tiling is needed</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">tiling_sizes</span><span class="p">]):</span>
        <span class="k">return</span>

    <span class="c1"># Add full transform dialect code into the main code</span>
    <span class="n">transform_code</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">module attributes </span><span class="se">{{</span><span class="s1">transform.with_named_sequence</span><span class="se">}}</span><span class="s1"> </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  transform.named_sequence @__transform_main(%arg1: !transform.any_op </span><span class="se">{{</span><span class="s1">transform.readonly</span><span class="se">}}</span><span class="s1">) </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> = transform.structured.match attributes</span><span class="se">{{</span><span class="s1">tag = &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">}}</span><span class="s1"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %op_tiled_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1">, %forall_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> = transform.structured.tile_using_forall %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> tile_sizes </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">tiling_sizes</span><span class="p">)</span><span class="si">}</span><span class="s1"> : (!transform.any_op) -&gt; (!transform.any_op, !transform.any_op)</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    transform.yield</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  </span><span class="se">}}\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="se">}}</span><span class="s1">&#39;</span>
    <span class="p">)</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_bufferize_and_lower_v" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_bufferize_and_lower_v</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_bufferize_and_lower_v" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply bufferization and lowering transformations for vectorized execution.</p>
<p>Applies a comprehensive series of transformations including bufferization,
vectorization, and lowering to prepare code for execution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_bufferize_and_lower_v</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply bufferization and lowering transformations for vectorized execution.</span>

<span class="sd">    Applies a comprehensive series of transformations including bufferization,</span>
<span class="sd">    vectorization, and lowering to prepare code for execution.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transform_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    module attributes </span><span class="si">{transform.with_named_sequence}</span><span class="s2"> {</span>
<span class="s2">        transform.named_sequence @__transform_main(</span><span class="si">%a</span><span class="s2">rg0: !transform.any_op </span><span class="si">{transform.consumed}</span><span class="s2">) {</span>
<span class="s2">            </span><span class="si">%a</span><span class="s2">ll_loops = transform.structured.match interface</span><span class="si">{LoopLikeInterface}</span><span class="s2"> in </span><span class="si">%a</span><span class="s2">rg0 : (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            transform.apply_licm to </span><span class="si">%a</span><span class="s2">ll_loops : !transform.any_op</span>

<span class="s2">            transform.structured.eliminate_empty_tensors </span><span class="si">%a</span><span class="s2">rg0 : !transform.any_op</span>
<span class="s2">            </span><span class="si">%e</span><span class="s2">mpty = transform.structured.match ops{[&quot;tensor.empty&quot;]} in </span><span class="si">%a</span><span class="s2">rg0 : (!transform.any_op) -&gt; !transform.op&lt;&quot;tensor.empty&quot;&gt;</span>
<span class="s2">            transform.bufferization.empty_tensor_to_alloc_tensor </span><span class="si">%e</span><span class="s2">mpty : (!transform.op&lt;&quot;tensor.empty&quot;&gt;) -&gt; !transform.op&lt;&quot;bufferization.alloc_tensor&quot;&gt;</span>

<span class="s2">            </span><span class="si">%f</span><span class="s2">0 = transform.structured.match ops{[&quot;func.func&quot;]} in </span><span class="si">%a</span><span class="s2">rg0 : (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            transform.apply_patterns to </span><span class="si">%f</span><span class="s2">0 {</span>
<span class="s2">                transform.apply_patterns.vector.transfer_permutation_patterns</span>
<span class="s2">                transform.apply_patterns.vector.reduction_to_contract</span>
<span class="s2">            } : !transform.any_op</span>
<span class="s2">            transform.apply_patterns to </span><span class="si">%f</span><span class="s2">0 {</span>
<span class="s2">                transform.apply_patterns.canonicalization</span>
<span class="s2">                transform.apply_patterns.tensor.fold_tensor_subset_ops_into_vector_transfers</span>
<span class="s2">            } : !transform.any_op</span>

<span class="s2">            </span><span class="si">%a</span><span class="s2">rg1 = transform.bufferization.one_shot_bufferize layout</span><span class="si">{IdentityLayoutMap}</span><span class="s2"> </span><span class="si">%a</span><span class="s2">rg0 {bufferize_function_boundaries = true} : (!transform.any_op) -&gt; !transform.any_op</span>

<span class="s2">            </span><span class="si">%f</span><span class="s2">1 = transform.structured.match ops{[&quot;func.func&quot;]} in </span><span class="si">%a</span><span class="s2">rg1 : (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            transform.apply_patterns to </span><span class="si">%f</span><span class="s2">1 {</span>
<span class="s2">                transform.apply_patterns.vector.lower_contraction lowering_strategy = &quot;outerproduct&quot;</span>
<span class="s2">                transform.apply_patterns.vector.transfer_permutation_patterns</span>
<span class="s2">                transform.apply_patterns.vector.lower_multi_reduction lowering_strategy = &quot;innerparallel&quot;</span>
<span class="s2">                transform.apply_patterns.vector.split_transfer_full_partial split_transfer_strategy = &quot;linalg-copy&quot;</span>
<span class="s2">                transform.apply_patterns.vector.transfer_to_scf max_transfer_rank = 1 full_unroll = true</span>
<span class="s2">                transform.apply_patterns.vector.lower_transfer max_transfer_rank = 1</span>
<span class="s2">                transform.apply_patterns.vector.lower_shape_cast</span>
<span class="s2">                transform.apply_patterns.vector.lower_transpose lowering_strategy = &quot;shuffle_1d&quot;</span>
<span class="s2">                transform.apply_patterns.canonicalization</span>
<span class="s2">            } : !transform.any_op</span>
<span class="s2">            transform.yield</span>
<span class="s2">        }</span>
<span class="s2">    }&quot;&quot;&quot;</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_decompose" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_decompose</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_decompose" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply decomposition transformation to an operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the operation to decompose.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_decompose</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply decomposition transformation to an operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the operation to decompose.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transform_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    module attributes </span><span class="se">{{</span><span class="s2">transform.with_named_sequence</span><span class="se">}}</span><span class="s2"> </span><span class="se">{{</span>
<span class="s2">        transform.named_sequence @__transform_main(%arg1: !transform.any_op </span><span class="se">{{</span><span class="s2">transform.readonly</span><span class="se">}}</span><span class="s2">) </span><span class="se">{{</span>
<span class="s2">            %conv = transform.structured.match attributes</span><span class="se">{{</span><span class="s2">tag = &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="se">}}</span><span class="s2"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            %decomposed = transform.structured.decompose %conv: (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            %decomposed_tag = transform.param.constant &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2">&quot; -&gt; !transform.any_param</span>
<span class="s2">            transform.annotate %decomposed &quot;tag&quot; = %decomposed_tag : !transform.any_op, !transform.any_param</span>
<span class="s2">            transform.yield</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    </span><span class="se">}}</span><span class="s2">&quot;&quot;&quot;</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_img2col" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_img2col</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_img2col" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply img2col transformation to convert convolution to matrix multiplication.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the convolution operation to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_img2col</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply img2col transformation to convert convolution to matrix multiplication.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the convolution operation to transform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transform_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">module attributes </span><span class="se">{{</span><span class="s2">transform.with_named_sequence</span><span class="se">}}</span><span class="s2"> </span><span class="se">{{</span>
<span class="s2">  transform.named_sequence @__transform_main(%arg1: !transform.any_op </span><span class="se">{{</span><span class="s2">transform.readonly</span><span class="se">}}</span><span class="s2">) </span><span class="se">{{</span>
<span class="s2">    %op_operation = transform.structured.match attributes</span><span class="se">{{</span><span class="s2">tag = &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="se">}}</span><span class="s2"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span>

<span class="s2">    transform.structured.convert_conv2d_to_img2col %op_operation : (!transform.any_op) -&gt; (!transform.any_op, !transform.any_op)</span>

<span class="s2">    transform.yield</span>
<span class="s2">  </span><span class="se">}}</span>
<span class="se">}}</span><span class="s2">&quot;&quot;&quot;</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_interchange" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_interchange</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">,</span> <span class="n">interchange_list</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_interchange" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply loop interchange transformation to an operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the operation to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interchange_list</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Permutation of loop indices defining the new loop order.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_interchange</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">interchange_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply loop interchange transformation to an operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the operation to transform.</span>
<span class="sd">        interchange_list (list[int]): Permutation of loop indices defining the new loop order.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If the permutation list is same as the identity permutation, means no interchange is needed</span>
    <span class="k">if</span> <span class="n">interchange_list</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interchange_list</span><span class="p">))):</span>
        <span class="k">return</span>

    <span class="n">transform_code</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;module attributes </span><span class="se">{{</span><span class="s1">transform.with_named_sequence</span><span class="se">}}</span><span class="s1"> </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  transform.named_sequence @__transform_main(%arg1: !transform.any_op </span><span class="se">{{</span><span class="s1">transform.readonly</span><span class="se">}}</span><span class="s1">) </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> = transform.structured.match attributes</span><span class="se">{{</span><span class="s1">tag = &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">}}</span><span class="s1"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %gen_op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> = transform.structured.generalize %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> : (!transform.any_op) -&gt; !transform.any_op</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %interchanged_op = transform.structured.interchange %gen_op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> iterator_interchange = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">interchange_list</span><span class="p">)</span><span class="si">}</span><span class="s1"> : (!transform.any_op) -&gt; !transform.any_op</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %interchanged_tag = transform.param.constant &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1">&quot; -&gt; !transform.any_param</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    transform.annotate %interchanged_op &quot;tag&quot; = %interchanged_tag : !transform.any_op, !transform.any_param</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    transform.yield</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  </span><span class="se">}}\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="se">}}\n</span><span class="s1">&#39;</span>
    <span class="p">)</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_pre_vec" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_pre_vec</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_pre_vec" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply pre-vectorization transformation to eliminate unit-stride accesses.</p>
<p>Eliminates accesses with constant 1 stride by adding subviews, which enables
better vectorization opportunities.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the operation to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_pre_vec</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply pre-vectorization transformation to eliminate unit-stride accesses.</span>

<span class="sd">    Eliminates accesses with constant 1 stride by adding subviews, which enables</span>
<span class="sd">    better vectorization opportunities.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the operation to transform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">code_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PRE_VEC_BIN_PATH&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="nb">input</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">module</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span>
        <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
    <span class="p">)</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">code_process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">code_process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">code_process</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

    <span class="n">new_module</span> <span class="o">=</span> <span class="n">Module</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>

    <span class="n">move_module</span><span class="p">(</span><span class="n">new_module</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_tile" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_tile</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">,</span> <span class="n">tiling_sizes</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_tile" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply tiling transformation to an operation using for loops.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the operation to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tiling_sizes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tiling factors for each loop.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_tile</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tiling_sizes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply tiling transformation to an operation using for loops.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the operation to transform.</span>
<span class="sd">        tiling_sizes (list[int]): List of tiling factors for each loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If tiling sizes are all zeros, means no tiling is needed</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">tiling_sizes</span><span class="p">]):</span>
        <span class="k">return</span>

    <span class="n">n_loops</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">s</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tiling_sizes</span><span class="p">])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;!transform.any_op&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_loops</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">n_loops</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;No loops to tile&quot;</span>

    <span class="n">transform_code</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">module attributes </span><span class="se">{{</span><span class="s1">transform.with_named_sequence</span><span class="se">}}</span><span class="s1"> </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  transform.named_sequence @__transform_main(%arg1: !transform.any_op </span><span class="se">{{</span><span class="s1">transform.readonly</span><span class="se">}}</span><span class="s1">) </span><span class="se">{{\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> = transform.structured.match attributes</span><span class="se">{{</span><span class="s1">tag = &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">}}</span><span class="s1"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    %tiled_op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1">, %loops:</span><span class="si">{</span><span class="n">n_loops</span><span class="si">}</span><span class="s1"> = transform.structured.tile_using_for %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s1"> tile_sizes </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">tiling_sizes</span><span class="p">)</span><span class="si">}</span><span class="s1"> : (!transform.any_op) -&gt; (!transform.any_op, </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;    transform.yield</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;  </span><span class="se">}}\n</span><span class="s1">&#39;</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="se">}}\n</span><span class="s1">&#39;</span>
    <span class="p">)</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_transpose_conv_2d" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_transpose_conv_2d</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_transpose_conv_2d" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply transposed convolution transformation to an operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the convolution operation to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_transpose_conv_2d</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply transposed convolution transformation to an operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the convolution operation to transform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transform_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    module attributes </span><span class="se">{{</span><span class="s2">transform.with_named_sequence</span><span class="se">}}</span><span class="s2"> </span><span class="se">{{</span>
<span class="s2">        transform.named_sequence @__transform_main(%arg1: !transform.any_op </span><span class="se">{{</span><span class="s2">transform.readonly</span><span class="se">}}</span><span class="s2">) </span><span class="se">{{</span>
<span class="s2">            %conv = transform.structured.match attributes</span><span class="se">{{</span><span class="s2">tag = &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="se">}}</span><span class="s2"> in %arg1 : (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            %transposed = transform.structured.transpose_conv2d %conv : (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            %transposed_tag = transform.param.constant &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2">&quot; -&gt; !transform.any_param</span>
<span class="s2">            transform.annotate %transposed &quot;tag&quot; = %transposed_tag : !transform.any_op, !transform.any_param</span>
<span class="s2">            transform.yield</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    </span><span class="se">}}</span><span class="s2">&quot;&quot;&quot;</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mlir_rl_artifact.transforms.transform_vectorize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">transform_vectorize</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">)</span></code>

<a href="#mlir_rl_artifact.transforms.transform_vectorize" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply vectorization transformation to an operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="mlir._mlir_libs._mlir.ir.Module" href="https://mlir.llvm.org/python-bindings/autoapi/mlir/_mlir_libs/_mlir/ir/index.html#mlir._mlir_libs._mlir.ir.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MLIR module to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_tag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tag of the operation to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>mlir_rl_artifact/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transform_vectorize</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">operation_tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply vectorization transformation to an operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Module): The MLIR module to transform.</span>
<span class="sd">        operation_tag (str): The tag of the operation to transform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transform_code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    module attributes </span><span class="se">{{</span><span class="s2">transform.with_named_sequence</span><span class="se">}}</span><span class="s2"> </span><span class="se">{{</span>
<span class="s2">        transform.named_sequence @__transform_main(%arg0: !transform.any_op </span><span class="se">{{</span><span class="s2">transform.readonly</span><span class="se">}}</span><span class="s2">) </span><span class="se">{{</span>
<span class="s2">            %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2"> = transform.structured.match attributes</span><span class="se">{{</span><span class="s2">tag = &quot;</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="se">}}</span><span class="s2"> in %arg0 : (!transform.any_op) -&gt; !transform.any_op</span>
<span class="s2">            transform.structured.vectorize %op_</span><span class="si">{</span><span class="n">operation_tag</span><span class="si">}</span><span class="s2"> : !transform.any_op</span>
<span class="s2">            transform.yield</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">    </span><span class="se">}}</span><span class="s2">&quot;&quot;&quot;</span>

    <span class="n">__run_transform_code_wrapper</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">transform_code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>